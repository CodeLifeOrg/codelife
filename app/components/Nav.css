@import '../mixins.css';

/* main nav bar */
.nav {
  /* positioning */
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding-left: var(--gutter-sm);
  padding-right: 0; /* account for var(--gutter-sm) .link padding */
  /* always on top */
  z-index: 20;
  /* sizing */
  height: var(--nav-height);

  /* make room for search bar */
  @add-mixin max-xs {
    /* allow content & padding to dictate height */
    height: auto;
    padding-top: var(--gutter-xs);
    padding-bottom: var(--gutter-lg);
  }

  /* increase padding on bigger screens */
  @add-mixin min-md {
    padding-right: var(--gutter-xs); /* account for var(--gutter-sm) .link padding */
    padding-left: var(--gutter-md);
  }

  /* rebalance flex item widths */
  @add-mixin min-lg {
    & > .logo,
    & > .links {
      flex: 2 2 0;
    }
    & > .search {
      flex: 1 1 0;
    }
  }

  /* logo */
  & .logo-link {
    display: inline-block; /* size img, contain tag */
    vertical-align: middle;
    height: 20px;
    /* transitions */
    transition:
      transform 0.2s;

    /* huge logo (home page only) */
    @add-mixin min-md {
      &.is-huge {
        transform: scale(1.75) translateX(15%);

        & .logo-tag {
          opacity: 0;
        }
      }
    }

    /* beta */
    & .logo-tag {
      /* positioning */
      position: absolute;
      top: -1.5em;
      text-align: right;
      /* sizing */
      width: 100%; /* increase clickability */
      /* typography */
      font-weight: 800;
      text-transform: uppercase;
      /* theming */
      color: var(--sky-dark);
      /* transitions */
      transition: opacity 0.2s;
    }

    & .logo-text {
      max-height: 100%;
      transition: transform 0.1s;
    }

    /* interactions */
    &:hover, &:focus {
      & .logo-text {
        transform: scale(1.1);
      }
    }
  }

  /* search bar placement */
  & > .search-container {

    /* positioned above the rest on small viewports */
    @add-mixin max-xs {
      position: absolute;
      bottom: var(--gutter-xs);
      left: var(--gutter-sm);
      width: 100%;

      & .search-label,
      & .search-input {
        font-size: 0.75rem;
      }
      & .search-label {
        top: 0.55em;
        z-index: 3;
      }
      & .search-input {
        width: calc(100% - 30px);
        z-index: 2;
      }
    }

    /* centered */
    @add-mixin min-md {
      margin-left: var(--gutter-sm);
      margin-right: var(--gutter-sm);

      /* width dictated by flex */
      & .search-input {
        width: 100%;
      }
    }

    /* results */
    & .search-results-outer {
      /* positioning */
      position: absolute;
      margin-top: 0.5rem;
      /* sizing */
      width: 100%;
      width: calc(100vw - 30px);
      min-height: 7.875rem; /* should equal search message + padding */
      max-height: 90vh; /* fallback */
      max-height: calc(100vh - 120px);
      overflow-y: auto;
      padding: var(--gutter-sm);
      /* theming */
      background-color: var(--white);
      border-radius: var(--radius-md);
      box-shadow: 0 2px 2em rgba(8, 26, 24, 0.1);
      /* transitions */
      transition:
        opacity 0.3s ease-out;

      &.is-hidden {
        transform: translateY(-300px);
        opacity: 0;
      }

      @add-mixin min-xs {
        position: fixed;
        margin-top: 0;
        top: var(--nav-height);
        left: var(--gutter-sm);

        /* two column layout */
        & .search-results-inner {
          /* sizing */
          display: inline-block;
          width: 50%; /* fallback */
          width: calc(50% - 1em); /* account for margin */
          /* positioning */
          margin-left: calc(0.5em);
          margin-right: calc(0.5em);
          vertical-align: top; /* thanks blueprint */
        }
      }

      /* keep it centered */
      @add-mixin min-lg {
        @add-mixin absolute-horizontal-center;
        top: 3rem;
        width: 40rem;
      }
    }
  }

  /* messages */
  & .search-results-message {
    padding-top: 2rem;
    padding-bottom: 2rem;

    &.is-hidden {
      display: none;
    }
  }

  /* main nav list */
  & .links {
    text-align: right; /* keep links on the right */

    & .link {
      @add-mixin nav-link;
      /* sizing */
      padding: 0.25em var(--gutter-sm);

      /* interactions */
      &:hover, &:focus {
        color: var(--black);
      }

      /* remove right padding from map link, bring in browser toggle */
      &.map-link {
        padding-right: 0;
      }

      /* tiny screens */
      @add-mixin max-sm {
        /* reduce padding */
        & {
          padding-left: var(--gutter-xs);
          padding-right: var(--gutter-xs);
        }
        /* increase icon size */
        & .link-icon {
          font-size: 22px;
        }
        /* hide link text */
        & .link-text {
          display: none;
        }
      }

      @add-mixin min-xs {
        & .link-icon {
          margin-right: var(--gutter-xxs);
        }
      }
    }
  }
}

/* slide browser */
.browser {
  display: inline-block;

  /* chevron toggle button */
  & .browser-toggle {
    @add-mixin nav-link;
    padding: 0.25em;

    /* interactions */
    &:hover, &:focus {
      color: var(--black);
    }
  }
}

/* browser popover —  not nested within .browser */
.browser-popover {
  background-color: var(--white);
  width: 250px;
  height: auto;

  & > .pt-popover-content {
    width: auto; /* override default width: max-content */
    background-color: var(--white);

    & > .browser-list {
      /* account for 20px padding on parent,
      which is necessary to hide the popover arrow shadow */
      margin: -20px;
      padding: var(--gutter-xs) 0;

      /* active node */
      & .pt-tree-node-selected > .pt-tree-node-content {
        background-color: var(--sky-dark);
      }
    }
  }
}

/* user popover */
.user-popover {
  & .pt-button {
    display: block;
    margin-bottom: var(--gutter-xs);
    width: 125px;
  }
}
